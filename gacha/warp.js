const pool = {
    "fivestar": {
        baseChance: 0.006,
        consolidatedChance: 0.016,
        "items": {
            baseChance: 0.5,
            "featured": {
                        itemName: "Jing Yuan",
                        rarity: 5,
                        pic: "./assets/jing.png",
            },
            "nonFeatured": {
                "1": {
                        itemName: "Bronya",
                        rarity: 5,
                        pic: "./assets/bronya.png",
                },
                "2": {
                        itemName: "Clara",
                        rarity: 5,
                        pic: "./assets/clara.png",
                },
                "3": {
                        itemName: "Himeko",
                        rarity: 5,
                        pic: "./assets/himeko.png",
                },
                "4": {
                        itemName: "Welt",
                        rarity: 5,
                        pic: "./assets/welt.png",
                },
                "5": {
                        itemName: "Gepard",
                        rarity: 5,
                        pic: "./assets/gepard.png",
                },
                "6": {
                        itemName: "Bailu",
                        rarity: 5,
                        pic: "./assets/bailu.png",
                },
                "7": {
                        itemName: "Yanqing",
                        rarity: 5,
                        pic: "./assets/yanqing.png",
                },
            },
        },
    },
    "fourstar": {
        baseChance: 0.051,
        consolidatedChance: 0.13,
        "characters": {
            baseChance: 0.0255,
            "items": {
                baseChance: 0.5,
                "featured": {
                    "1": {
                        itemName: "Sushang",
                        rarity: 4,
                        pic: "./assets/1.png",
                    },
                    "2": {
                        itemName: "Tingyun",
                        rarity: 4,
                        pic: "./assets/2.png",
                    },
                    "3": {
                        itemName: "March 7th",
                        rarity: 4,
                        pic: "./assets/3.png",
                    },
                },
                "nonFeatured": {
                    "1": {
                        itemName: "Asta",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "2": {
                        itemName: "Herta",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "3": {
                        itemName: "Natasha",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "4": {
                        itemName: "Arlan",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "5": {
                        itemName: "Pela",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "6": {
                        itemName: "Sampo",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "7": {
                        itemName: "Hook",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "8": {
                        itemName: "Dan Heng",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "9": {
                        itemName: "Qingque",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                    "10": {
                        itemName: "Serval",
                        rarity: 4,
                        pic: "./assets/lc.png",
                    },
                },
            },
        },
        "lightCones": {
            baseChance: 0.0255,
            "items": {
                "1": {
                    itemName: "Post-Op Conversation",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "2": {
                    itemName:  "Good Night and Sleep Well",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "3": {
                    itemName:  "Day One of My New Life",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "4": {
                    itemName:  "Only Silence Remains",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "5": {
                    itemName:  "Memories of the Past",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "6": {
                    itemName:  "The Moles Welcome You",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "7": {
                    itemName:  "The Birth of Self",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "8": {
                    itemName:  "Shared Feeling",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "9": {
                    itemName:  "Eyes of the Prey",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "10": {
                    itemName:  "Landau's Choice",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "11": {
                    itemName:  "Swordplay",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "12": {
                    itemName:  "Planetary Rendezvous",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "1lc": {
                    itemName:  "A Secret Vow",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "14": {
                    itemName:  "Make the World Clamor",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "15": {
                    itemName:  "Perfect Timing",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "16": {
                    itemName:  "Resolution Shines as Pearls of Sweat",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "17": {
                    itemName:  "Trend of the Universal Market",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "18": {
                    itemName:  "Subscribe for More!",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "19": {
                    itemName:  "Dance!Dance!Dance!",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "20": {
                    itemName:  "Under the Blue Sky",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
                "21": {
                    itemName:  "Geniuses' Response",
                    rarity: 4,
                    pic: "./assets/lc.png",
                },
            },
        },
    },
    "threeStar": {
        baseChance: 0.943,
        consolidatedChance: 0.854,
        "items": {

            "1": {
                itemName:  "Arrows",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "2": {
                itemName:  "Cornucopia",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "3": {
                itemName:  "Collapsing Sky",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "4": {
                itemName:  "Amber",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "5": {
                itemName:  "Void",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "6": {
                itemName:  "Chorus",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "7": {
                itemName:  "Data Bank",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "8": {
                itemName:  "Darting Arrow",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "9": {
                itemName:  "Fine Fruit",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "10": {
                itemName:  "Shattered Home",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "11": {
                itemName:  "Defense",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "12": {
                itemName:  "Loop",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "13": {
                itemName:  "Meshing Cogs",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "14": {
                itemName:  "Passkey",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "15": {
                itemName:  "Adversarial",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "16": {
                itemName:  "Multiplication",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "17": {
                itemName:  "Mutual Demise",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "18": {
                itemName:  "Pioneering",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "19": {
                itemName:  "Hidden Shadow",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "20": {
                itemName:  "Mediation",
                rarity: 3,
                pic: "./assets/lc.png",
            },
            "21": {
                itemName:  "Sagacity",
                rarity: 3,
                pic: "./assets/lc.png",
            },
        },
    },
};

let counter = 0;
const btnOne = document.getElementById("one")
const btnTen = document.getElementById("ten")
btnOne.addEventListener("click", singleWarp);
btnTen.addEventListener("click", tenWarp);
const one = document.getElementById("onePull");
const ten = document.getElementById("tenPull");
const clOne = document.getElementById("closeOne");
clOne.addEventListener("click", closeOne);
const clTen = document.getElementById("closeTen");
clTen.addEventListener("click", closeTen)

function closeOne() {
        one.classList.replace("show", "hide");
        btnTen.style.pointerEvents = "all";
}

function closeTen() {
        ten.classList.replace("showGrid", "hide");
        btnOne.style.pointerEvents = "all";
}

function warp(x) {
    const rate = Math.random()
    if (counter == "90") {
        return warp5(x)
    }
    else if (counter % 10 == 0) {
        return warp4(x)
    }
    else if (rate <= x.fivestar.baseChance){ // If its a 5* 
        return warp5(x)
    }
    else if (rate <= x.fourstar.baseChance){ //if its a 4*
        return warp4(x)
    }
    else if (rate <= x.threeStar.baseChance){
        return warp3(x)
    }
    else {
        return warp3(x)
    }
}

function warp5(x) {
    counter = 0
    if(Math.ceil(Math.random() * Object.keys(x.fivestar.items).length) === 1){
        return x.fivestar.items.featured
    }
    else {
        return x.fivestar.items.nonFeatured[Math.ceil(Math.random() * Object.keys(x.fivestar.items.nonFeatured).length)]
    }
}


function warp4(x) {
    const rate4 = Math.random()
    if (rate4 <= x.fourstar.characters.baseChance){ //if character
        if (Math.random() <= x.fourstar.characters.items.baseChance){ // if < === featured
            console.log(Math.ceil(Math.random() * Object.keys(x.fourstar.characters.items.featured).length))
            return x.fourstar.characters.items.featured[Math.ceil(Math.random() * Object.keys(x.fourstar.characters.items.featured).length)]
        }
        else {
            return x.fourstar.characters.items.nonFeatured[Math.ceil(Math.random() * Object.keys(x.fourstar.characters.items.nonFeatured).length)]
        }
    }
    else { //if lightcone
        return x.fourstar.lightCones.items[Math.ceil(Math.random() * Object.keys(x.fourstar.lightCones.items).length)]
    }
}


function warp3(x) {
    return x.threeStar.items[Math.ceil(Math.random() * Object.keys(x.threeStar.items).length)]
}

function singleWarp() {
    btnTen.style.pointerEvents = "none";
    document.getElementById("num").innerHTML = counter + 1;
    counter++;
    const pull = warp(pool)
    console.log(pull.rarity + ": " + pull.itemName)
    one.classList.replace("hide","show");
    document.getElementById("image").src = pull.pic;
    document.getElementById("itemName").innerHTML = pull.itemName;
}

function tenWarp() {
    btnOne.style.pointerEvents = "none";
    const tenPullItemName = ["itemName1", "itemName2", "itemName3", "itemName4", "itemName5","itemName6","itemName7","itemName8","itemName9", "itemName0"]
    const tenpullImg = ["img1", "img2", "img3", "img4", "img5","img6","img7","img8","img9", "img0"]
    let item = []
    document.getElementById("num").innerHTML = counter + 10;
    counter += 10;
    for(let warps = 0; warps < 10; warps++){
        item[warps] = warp(pool)
        console.log(item[warps].rarity + ": " + item[warps].itemName)
    }
    ten.classList.replace("hide","showGrid");
    for(let warp = 0; warp < 10; warp++){
        document.getElementById(tenPullItemName[warp]).innerHTML = item[warp].itemName;
        document.getElementById(tenpullImg[warp]).src = item[warp].pic;
    } 
}





